#ifndef __MENU_H__
#define __MENU_H__

#include "zf_common_headfile.h"
#include "key.h"

// ????????????
#define MAX_MENU_ITEMS 10
// ???????????
#define MAX_MENU_NAME_LEN 20

// ????????
typedef struct MenuItem {
    char name[MAX_MENU_NAME_LEN];          // ?????????
    void (*function)(void);                // ??????????
    struct Menu* subMenu;                  // ???????
} MenuItem;

// ???????
typedef struct Menu {
    char title[MAX_MENU_NAME_LEN];         // ???????
    MenuItem items[MAX_MENU_ITEMS];        // ?????????
    uint8 itemCount;                       // ?????????
    uint8 currentSelection;                // ????????
    struct Menu* parentMenu;               // ????????
} Menu;

// ??????????
void menu_init(void);

// ??????
void menu_display(Menu* menu);

// 只更新菜单选择项，不刷新整个菜单
void menu_update_selection(Menu* menu, uint8 oldSelection, uint8 newSelection);

// ?????????????????????????
Menu* menu_process(Menu* currentMenu);

// ???????????????
void menu_key_handler(Menu* menu, uint8 key);

// ?????????
void menu_create_item(Menu* menu, const char* name, void (*function)(void), Menu* subMenu);

// ???????????
void menu_set_current(Menu* menu);

// ???????????
Menu* menu_get_current(void);

// ????????
Menu* menu_enter_submenu(Menu* currentMenu);

// ????????
Menu* menu_return_parent(Menu* currentMenu);

// ?????е???????
void menu_execute_function(Menu* menu);

// ????????
void menu_exit(void);

// ???ò????????
void menu_reset_exit_flag(void);

extern Menu* g_currentMenu;  // ????????
extern uint8 g_menu_exit_flag;  // ???????????1??????

#endif /* __MENU_H__ */